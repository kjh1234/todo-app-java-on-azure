pipeline {
  agent any
  stages {
    stage('Checkout') {
      steps {
        checkout([
                    $class: 'GitSCM', 
                    userRemoteConfigs: [[url: GIT_REPOSITORY_URL, credentialsId: GIT_CREDENTIALS_ID ]], 
                    branches: [[name: GIT_BRANCH]]
                  ])
        }
      }

      stage('Build') {
        steps {
          sh 'mvn -Dmaven.test.failure.ignore=true clean package'
        }
      }
      
      stage('Deploy') {
        steps {
          ftpPublisher alwaysPublishFromMaster: true, continueOnError: false, failOnError: false, publishers: [
        [configName: 'YOUR_CONFIG_HERE', transfers: [
            [asciiMode: false, cleanRemote: false, excludes: '', flatten: false, makeEmptyDirs: false, noDefaultExcludes: false, patternSeparator: '[, ]+', remoteDirectory: "YOUR_DIRECTORY_HERE", remoteDirectorySDF: false, removePrefix: '', sourceFiles: '**.exe, **.txt']
        ], usePromotionTimestamp: false, useWorkspaceInPromotion: false, verbose: true]
    ]
        }
      }

    }
    environment {
      GIT_REPOSITORY_URL = 'https://github.com/kjh1234/todo-app-java-on-azure.git'
      GIT_CREDENTIALS_ID = '	GIT_CREDENTIALS_ID'
      GIT_BRANCH = '*/master'
    }
    parameters {
      string(name: 'TAG_VERSION', defaultValue: '', description: '')
    }
  }
